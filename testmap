<!DOCTYPE html>
<html>
<head>
  <title>Walking Route Distance</title>
  <style>
    #map {
      height: 100vh;
      width: 100%;
    }
    #info {
      position: absolute;
      top: 10px;
      left: 10px;
      background: white;
      padding: 10px;
      border-radius: 5px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.3);
      z-index: 5;
    }
  </style>
  <script src="https://maps.googleapis.com/maps/api/js?key=YOUR_API_KEY&libraries=drawing,geometry"></script>
</head>
<body>

<div id="info">
  <button onclick="startRoute()">Draw Route</button>
  <button onclick="startBoundary()">Draw Boundary</button>
  <button onclick="clearMap()">Clear</button>
  <div id="distance">Distance: 0 km</div>
</div>

<div id="map"></div>

<script>
let map;
let drawingManager;
let currentOverlay = null;

function initMap() {
  map = new google.maps.Map(document.getElementById("map"), {
    center: { lat: 40.7128, lng: -74.0060 },
    zoom: 14,
  });

  drawingManager = new google.maps.drawing.DrawingManager({
    drawingMode: null,
    drawingControl: false,
    drawingControlOptions: {
      drawingModes: ["polyline", "polygon"]
    },
    polylineOptions: {
      strokeColor: "#FF0000",
      strokeWeight: 4
    },
    polygonOptions: {
      fillColor: "#00FF00",
      fillOpacity: 0.3,
      strokeWeight: 2
    }
  });

  drawingManager.setMap(map);

  google.maps.event.addListener(drawingManager, "overlaycomplete", function(event) {
    if (currentOverlay) {
      currentOverlay.setMap(null);
    }
    currentOverlay = event.overlay;

    if (event.type === "polyline") {
      const path = currentOverlay.getPath();
      const distance = google.maps.geometry.spherical.computeLength(path);
      document.getElementById("distance").innerText =
        "Distance: " + (distance / 1000).toFixed(2) + " km";
    }
  });
}

function startRoute() {
  drawingManager.setDrawingMode(google.maps.drawing.OverlayType.POLYLINE);
}

function startBoundary() {
  drawingManager.setDrawingMode(google.maps.drawing.OverlayType.POLYGON);
}

function clearMap() {
  if (currentOverlay) {
    currentOverlay.setMap(null);
    currentOverlay = null;
    document.getElementById("distance").innerText = "Distance: 0 km";
  }
}

initMap();
</script>

</body>
</html>
